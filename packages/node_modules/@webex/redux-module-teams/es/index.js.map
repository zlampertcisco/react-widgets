{"version":3,"file":"index.js","sources":["../src/helpers.js","../src/actions.js","../src/reducer.js"],"sourcesContent":["export function constructTeam(team) {\n  return {\n    id: team.id,\n    color: team.teamColor,\n    generalConversationId: team.generalConversationUuid,\n    displayName: team.displayName,\n    description: team.summary,\n    status: {\n      isArchived: team.archived\n    }\n  };\n}\n\nexport function constructTeams(teams) {\n  return teams.map(constructTeam);\n}\n","import {constructTeams} from './helpers';\n\nexport const FETCH_TEAMS = 'teams/FETCH_TEAMS';\nexport const STORE_TEAMS = 'teams/STORE_TEAMS';\nexport const STORE_TEAMS_ERROR = 'teams/STORE_TEAMS_ERROR';\n\nfunction startFetchTeams() {\n  return {\n    type: FETCH_TEAMS\n  };\n}\n\nfunction storeTeamError(error) {\n  return {\n    type: STORE_TEAMS_ERROR,\n    payload: {\n      error\n    }\n  };\n}\n\nfunction storeTeams(teams) {\n  return {\n    type: STORE_TEAMS,\n    payload: {\n      teams: constructTeams(teams)\n    }\n  };\n}\n\n/**\n * Fetches teams from the conversation server\n * @param {object} sparkInstance\n * @returns {Thunk}\n */\nexport function fetchTeams(sparkInstance) {\n  return (dispatch) => {\n    dispatch(startFetchTeams());\n\n    return sparkInstance.internal.team.list()\n      .then((teams) => {\n        if (teams && teams.length) {\n          dispatch(storeTeams(teams));\n\n          return Promise.resolve(teams);\n        }\n\n        return Promise.resolve();\n      })\n      .catch((e) => {\n        dispatch(storeTeamError(e));\n\n        return Promise.reject(new Error('Could not fetch teams', e));\n      });\n  };\n}\n","import {fromJS, Record} from 'immutable';\n\nimport {\n  FETCH_TEAMS,\n  STORE_TEAMS,\n  STORE_TEAMS_ERROR\n} from './actions';\n\nconst Team = Record({\n  id: null,\n  color: '',\n  generalConversationId: null,\n  displayName: '',\n  description: '',\n  status: {\n    isArchived: false\n  }\n});\n\nconst Status = Record({\n  isFetching: false,\n  hasFetched: false,\n  error: undefined\n});\n\nexport const initialState = fromJS({\n  byId: {},\n  status: new Status()\n});\n\nexport default function reducer(state = initialState, action) {\n  switch (action.type) {\n    case FETCH_TEAMS: {\n      return state.setIn(['status', 'isFetching'], true);\n    }\n    case STORE_TEAMS: {\n      const teams = {};\n\n      action.payload.teams.forEach((t) => {\n        teams[t.id] = new Team(t);\n      });\n\n      return state\n        .mergeIn(['byId'], teams)\n        .set('status', new Status({\n          isFetching: false,\n          hasFetched: true,\n          error: undefined\n        }));\n    }\n    case STORE_TEAMS_ERROR: {\n      return state\n        .set('status', new Status({\n          isFetching: false,\n          hasFetched: false,\n          error: action.payload.error\n        }));\n    }\n    default:\n      return state;\n  }\n}\n\n"],"names":["constructTeam","team","id","color","teamColor","generalConversationId","generalConversationUuid","displayName","description","summary","status","isArchived","archived","constructTeams","teams","map","FETCH_TEAMS","STORE_TEAMS","STORE_TEAMS_ERROR","startFetchTeams","type","storeTeamError","error","payload","storeTeams","fetchTeams","sparkInstance","dispatch","internal","list","then","length","Promise","resolve","catch","e","reject","Error","Team","Record","Status","isFetching","hasFetched","undefined","initialState","fromJS","byId","reducer","state","action","setIn","forEach","t","mergeIn","set"],"mappings":"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"}