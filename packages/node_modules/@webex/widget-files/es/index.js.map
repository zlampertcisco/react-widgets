{"version":3,"file":"index.js","sources":["../src/components/ShareListingItem.js","../src/selectors.js","../../../../../node_modules/style-inject/dist/style-inject.es.js","../src/container.js","../src/reducer.js","../src/translations/en.js","../src/index.js"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport FileShareDisplay from '@webex/react-component-file-share-display';\nimport connectFileDownloader from '@webex/react-container-file-downloader';\n\nfunction ShareListingItem({fileShare, onDownloadClick, type}) {\n  return (\n    <div>\n      <FileShareDisplay\n        actor={fileShare.actor}\n        file={fileShare.item}\n        isFetching={fileShare.item.isFetching}\n        objectUrl={fileShare.item.objectUrl}\n        onDownloadClick={onDownloadClick}\n        type={type}\n        timestamp={fileShare.timestamp}\n      />\n    </div>\n  );\n}\n\nShareListingItem.propTypes = {\n  fileShare: PropTypes.shape({\n    actor: PropTypes.object,\n    activityId: PropTypes.string,\n    item: PropTypes.object,\n    timestamp: PropTypes.string\n  }).isRequired,\n  onDownloadClick: PropTypes.func.isRequired, // Injected via connectFileDownloader\n  type: PropTypes.string.isRequired\n};\n\nexport default connectFileDownloader(ShareListingItem);\n","import {createSelector} from 'reselect';\nimport moment from 'moment';\nimport {getActivitiesFromThreadAndNonThreadCollections} from '@webex/redux-module-conversation';\n\nconst getShare = (state) => state.share;\n\nconst getConversationThreadActivities = (state) => state.conversation.get('threadActivities');\nconst getConversationNonThreadActivities = (state) => state.conversation.get('sortNonThreadActivities');\n\n/**\n * Formats the published date to the format specified for content display\n * @param {String} dateString\n * @returns {String}\n */\nfunction formatDate(dateString) {\n  return moment(dateString).format('M/D/YY');\n}\n\n/**\n * Creates an array of \"content\" activities and their data from the share module\n * @param {Array} rawActivities An array of conversation activities\n * @param {Object} share The redux share module\n * @returns {Array}\n */\nfunction getFileShareActivities(rawActivities, share) {\n  const fileShares = [];\n\n  rawActivities.filter((activity) => activity.verb === 'share')\n    .forEach((activity) => {\n      if (activity.object.files && activity.object.files.items.length) {\n        activity.object.files.items.forEach((fileItem) => {\n          let isFetching = false;\n          let objectUrl;\n\n          if (fileItem.image) {\n            const thumbnail = fileItem.mimeType === 'image/gif' ? share.getIn(['files', fileItem.url]) : share.getIn(['files', fileItem.image.url]);\n\n            if (thumbnail) {\n              isFetching = thumbnail.get('isFetching');\n              objectUrl = thumbnail.get('objectUrl');\n            }\n          }\n          const fileShare = {\n            actor: activity.actor,\n            activityId: activity.id,\n            item: {\n              ...fileItem,\n              isFetching,\n              objectUrl\n            },\n            published: new Date(activity.published),\n            timestamp: formatDate(activity.published)\n          };\n\n          fileShares.push(fileShare);\n        });\n      }\n    });\n\n  return fileShares;\n}\n\n/**\n * Combines the threaded and non threaded activities by using the convo redux module\n * helper function\n */\nconst getConversationActivities = createSelector(\n  [\n    getConversationThreadActivities,\n    getConversationNonThreadActivities\n  ],\n  getActivitiesFromThreadAndNonThreadCollections\n);\n\n\nconst getFilesWidgetProps = createSelector(\n  [getConversationActivities, getShare],\n  (conversationActivities, share) => {\n    const fileShares = getFileShareActivities(conversationActivities, share);\n\n    return {\n      // Sort by newest content first\n      fileShares: fileShares.sort((a, b) => b.published - a.published)\n    };\n  }\n);\n\nexport default getFilesWidgetProps;\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\nimport {autobind} from 'core-decorators';\nimport classNames from 'classnames';\n\nimport ActivityMenuHeader from '@webex/react-component-activity-menu-header';\n\nimport ShareListingItem from './components/ShareListingItem';\n\nimport getFilesWidgetProps from './selectors';\n\nimport styles from './styles.css';\n\nconst ownPropTypes = {\n  onClickClose: PropTypes.func.isRequired,\n  onClickMenu: PropTypes.func.isRequired\n};\n\nconst injectedPropTypes = {\n  activityTypes: PropTypes.array.isRequired,\n  conversation: PropTypes.object.isRequired,\n  fileShares: PropTypes.array.isRequired\n};\n\nclass FilesWidget extends Component {\n  @autobind\n  handleMenuClick() {\n    this.props.onClickMenu();\n  }\n\n  @autobind\n  handleCloseClick() {\n    this.props.onClickClose();\n  }\n\n  render() {\n    return (\n      <div className={classNames('webex-widget-files', styles.widgetFiles)}>\n        <ActivityMenuHeader\n          activityTypes={this.props.activityTypes}\n          onClose={this.props.onClickClose && this.handleCloseClick}\n          onMenuClick={this.props.onClickMenu && this.handleMenuClick}\n          title={`Files (${this.props.fileShares.length})`}\n        />\n        <div className={classNames('webex-widget-files-main', styles.widgetFilesMain)}>\n          {\n            this.props.fileShares.length && (\n              <div>\n                {this.props.fileShares.map((fileShare) => (\n                  <ShareListingItem fileShare={fileShare} key={fileShare.item.url} type=\"file\" />\n                ))}\n              </div>\n            )\n          }\n          {\n            !this.props.fileShares.length && (\n              <div>No Files Found</div>\n            )\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nFilesWidget.propTypes = {\n  ...ownPropTypes,\n  ...injectedPropTypes\n};\n\nexport default connect(\n  getFilesWidgetProps\n)(FilesWidget);\n","import {combineReducers} from 'redux';\n\nimport conversation from '@webex/redux-module-conversation';\nimport share from '@webex/redux-module-share';\n\nexport const reducers = {\n  conversation,\n  share\n};\n\nexport default combineReducers(reducers);\n","export default {};\n","\nimport {compose} from 'recompose';\nimport {constructWebexEnhancer, withIntl} from '@webex/webex-widget-base';\n\nimport ConnectedFiles from './container';\nimport {reducers} from './reducer';\nimport messages from './translations/en';\n\nexport default compose(\n  constructWebexEnhancer({\n    name: 'files',\n    reducers\n  }),\n  withIntl({locale: 'en', messages})\n)(ConnectedFiles);\n"],"names":["ShareListingItem","fileShare","onDownloadClick","type","actor","item","isFetching","objectUrl","timestamp","propTypes","PropTypes","shape","object","activityId","string","isRequired","func","connectFileDownloader","getShare","state","share","getConversationThreadActivities","conversation","get","getConversationNonThreadActivities","formatDate","dateString","moment","format","getFileShareActivities","rawActivities","fileShares","filter","activity","verb","forEach","files","items","length","fileItem","image","thumbnail","mimeType","getIn","url","id","published","Date","push","getConversationActivities","createSelector","getActivitiesFromThreadAndNonThreadCollections","getFilesWidgetProps","conversationActivities","sort","a","b","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","ownPropTypes","onClickClose","onClickMenu","injectedPropTypes","activityTypes","array","FilesWidget","Component","handleMenuClick","props","handleCloseClick","render","classNames","styles","widgetFiles","widgetFilesMain","map","autobind","connect","reducers","combineReducers","compose","constructWebexEnhancer","name","withIntl","locale","messages","ConnectedFiles"],"mappings":"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"}