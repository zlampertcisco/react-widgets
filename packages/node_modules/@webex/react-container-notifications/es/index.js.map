{"version":3,"file":"index.js","sources":["../src/browserUtils.js","../src/selectors.js","../src/actions.js","../src/events.js","../src/container.js","../src/reducer.js"],"sourcesContent":["export const PERMISSION_GRANTED = 'granted';\nexport const PERMISSION_DENIED = 'denied';\n\n/**\n * Returns true if the main browser window is hidden, minimized,\n * or in the background; false otherwise.\n *\n * @returns {boolean} hidden\n */\nexport function isBrowserHidden() {\n  return document.webkitHidden\n    || document.mozHidden\n    || document.msHidden\n    || document.hidden\n    || !document.hasFocus();\n}\n\n/**\n * Checks if native browser notifications are supported\n *\n * @export\n * @returns {bool}\n */\nexport function isNotificationSupported() {\n  return window && window.Notification;\n}\n\nexport function requestPermissionForNotifications(callback) {\n  return window.Notification.requestPermission(callback);\n}\n\n/**\n * Displays a browser notification and automatically closes after timeout\n *\n * @param {String} theBody body of the notification\n * @param {String} theIcon the url of the icon to display\n * @param {String} theTitle\n * @param {Integer} timeoutLength non-zero amount of time to display the notification\n *\n * @returns {Object} Browser notification object\n *\n */\nexport function spawnNotification(theBody, theIcon, theTitle, timeoutLength) {\n  const options = {\n    body: theBody,\n    icon: theIcon\n  };\n  const browserNotification = new Notification(theTitle, options);\n\n  if (timeoutLength) {\n    setTimeout(() => {\n      browserNotification.close();\n    }, timeoutLength);\n  }\n\n  return browserNotification;\n}\n\nexport default {\n  PERMISSION_GRANTED,\n  PERMISSION_DENIED,\n  isBrowserHidden,\n  isNotificationSupported,\n  requestPermissionForNotifications,\n  spawnNotification\n};\n","import {createSelector} from 'reselect';\n\nconst getNotifications = (state) => state.notifications.get('items');\nconst getNotificationSettings = (state) => state.notifications.get('settings');\n\nconst getUnsentNotifications = createSelector(\n  [getNotifications],\n  (notifications) =>\n    notifications\n      .toArray()\n      .map((notification) => {\n        const {\n          username, message, avatar, alertType\n        } = notification.details;\n\n        return Object.assign({}, notification, {\n          username,\n          message,\n          avatar,\n          alertType\n        });\n      })\n);\n\nconst getNotificationDetails = createSelector(\n  [getNotificationSettings, getUnsentNotifications],\n  (notificationSettings, unsentNotifications) => ({\n    isSupported: notificationSettings.get('isSupported'),\n    notifications: unsentNotifications,\n    permission: notificationSettings.get('permission')\n  })\n);\n\nexport default getNotificationDetails;\n","export const ADD_NOTIFICATION = 'notifications/ADD_NOTIFICATION';\nexport const DELETE_NOTIFICATION = 'notifications/DELETE_NOTIFICATION';\nexport const UPDATE_NOTIFICATION_SETTING = 'notifications/UPDATE_NOTIFICATION_SETTING';\n\n\nfunction addNotification(notification) {\n  return {\n    type: ADD_NOTIFICATION,\n    payload: {\n      notification\n    }\n  };\n}\n\nfunction deleteNotification(notificationId) {\n  return {\n    type: DELETE_NOTIFICATION,\n    payload: {\n      notificationId\n    }\n  };\n}\n\nfunction updateNotificationSetting(setting) {\n  return {\n    type: UPDATE_NOTIFICATION_SETTING,\n    payload: {\n      setting\n    }\n  };\n}\n\n/**\n * Creates a new notification for processing\n *\n * @param {string} notificationId\n * @param {object} details\n * @param {string} details.message\n * @param {string} details.avatar\n * @param {string} details.username\n * @returns {function}\n */\nexport function createNotification(notificationId, details) {\n  return (dispatch) => dispatch(addNotification({notificationId, details}));\n}\n\n/**\n * Updates an existing notification to indicate that it was sent\n *\n * @param {string} notificationId\n * @returns {function}\n */\nexport function notificationSent(notificationId) {\n  return (dispatch) => dispatch(deleteNotification(notificationId));\n}\n\n/**\n * Changes the permission type after we've request notification\n * permissions from the user\n *\n * @param {String} permission\n * @returns {function}\n */\nexport function setNotificationPermission(permission) {\n  return (dispatch) => dispatch(updateNotificationSetting({permission}));\n}\n\n/**\n * Changes the setting for if native notifications are supported\n * by the user's device/browser\n *\n * @export\n * @param {bool} isSupported\n * @returns {function}\n */\nexport function setNotificationSupported(isSupported) {\n  return (dispatch) => dispatch(updateNotificationSetting({isSupported}));\n}\n","export const eventNames = {\n  NOTIFICATIONS_CREATED: 'notification:created',\n  NOTIFICATIONS_CLICKED: 'notification:clicked'\n};\n\n/**\n * Constructs an event detail object for notifications\n * @export\n * @param {Object} notification notification object\n * @param {Object} details event details\n * @returns {Object} constructed event\n */\nexport function constructNotificationEventData(notification, details) {\n  return Object.assign({}, details, {\n    notification\n  });\n}\n","import {Component} from 'react';\nimport {connect} from 'react-redux';\nimport {bindActionCreators} from 'redux';\nimport PropTypes from 'prop-types';\nimport _ from 'lodash';\n\nimport browserUtilities from './browserUtils';\nimport getNotificationDetails from './selectors';\nimport {\n  notificationSent,\n  setNotificationPermission,\n  setNotificationSupported\n} from './actions';\nimport {\n  eventNames,\n  constructNotificationEventData\n} from './events';\n\n\nconst TIMEOUT_LENGTH = 10000;\n\nconst propTypes = {\n  notifications: PropTypes.array,\n  isSupported: PropTypes.bool,\n  isMuted: PropTypes.bool,\n  permission: PropTypes.string,\n  onEvent: PropTypes.func,\n  notificationSent: PropTypes.func,\n  setNotificationPermission: PropTypes.func,\n  setNotificationSupported: PropTypes.func\n\n};\n\nconst defaultProps = {\n  notifications: [],\n  isSupported: false,\n  isMuted: false,\n  permission: '',\n  onEvent: null,\n  notificationSent: null,\n  setNotificationPermission: null,\n  setNotificationSupported: null\n};\n\nexport class Notifications extends Component {\n  componentDidMount() {\n    const {props} = this;\n\n    // Default state is not supported, once we know it is, don't check any more\n    this.setup(props);\n    this.displayNotifications();\n  }\n\n  shouldComponentUpdate(nextProps) {\n    const {props} = this;\n\n    return nextProps.notifications !== props.notifications\n      || nextProps.isSupported !== props.isSupported\n      || nextProps.permission !== props.permission;\n  }\n\n  componentDidUpdate() {\n    this.setup(this.props);\n    this.displayNotifications();\n  }\n\n  /**\n   * Check for permissions and support\n   *\n   * @param {object} props\n   * @returns null\n   */\n\n  setup(props) {\n    if (!props.isSupported) {\n      this.checkSupported();\n    }\n    if (_.isNull(props.permission) && props.isSupported) {\n      this.requestPermission();\n    }\n  }\n\n  /**\n   * Requests permission from the browser to allow notifications\n   *\n   * @returns {Promise}\n   */\n  requestPermission() {\n    const {props} = this;\n\n    return browserUtilities.requestPermissionForNotifications(\n      (permission) => props.setNotificationPermission(permission)\n    );\n  }\n\n  /**\n   * Checks if browser notifications are supported and updates store\n   *\n   */\n  checkSupported() {\n    const {props} = this;\n\n    if (!props.isSupported && browserUtilities.isNotificationSupported()) {\n      props.setNotificationSupported(true);\n    }\n  }\n\n  /**\n   * Processes notifications and displays them if needed\n   *\n   */\n  displayNotifications() {\n    const {\n      notifications, onEvent, permission, isMuted\n    } = this.props;\n    const hasPermission = permission === browserUtilities.PERMISSION_GRANTED;\n\n    if (notifications && notifications.length > 0) {\n      notifications.forEach((notification) => {\n        const {\n          username, message, avatar, notificationId, alertType\n        } = notification;\n\n        if (alertType !== 'none' && !isMuted && hasPermission && browserUtilities.isBrowserHidden()) {\n          // Actually display notification\n          const n = browserUtilities.spawnNotification(message, avatar, username, TIMEOUT_LENGTH);\n          // If there is an onEvent method\n          const details = constructNotificationEventData(n, notification);\n\n          if (onEvent && typeof onEvent === 'function') {\n            onEvent(eventNames.NOTIFICATIONS_CREATED, details);\n            n.addEventListener('click', () => {\n              onEvent(eventNames.NOTIFICATIONS_CLICKED, details);\n            });\n          }\n        }\n        this.props.notificationSent(notificationId);\n      });\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\nNotifications.propTypes = propTypes;\nNotifications.defaultProps = defaultProps;\n\nexport default connect(\n  getNotificationDetails,\n  (dispatch) => bindActionCreators({\n    notificationSent,\n    setNotificationPermission,\n    setNotificationSupported\n  }, dispatch)\n)(Notifications);\n","import {fromJS} from 'immutable';\n\nimport {\n  ADD_NOTIFICATION,\n  DELETE_NOTIFICATION,\n  UPDATE_NOTIFICATION_SETTING\n} from './actions';\n\nexport const initialState = fromJS({\n  items: {},\n  settings: {\n    isSupported: null,\n    permission: null\n  }\n});\n\nexport default function reducer(state = initialState, action) {\n  switch (action.type) {\n    case ADD_NOTIFICATION: {\n      const {notificationId, type, details} = action.payload.notification;\n      const notification = {\n        notificationId,\n        type,\n        details\n      };\n\n      return state.setIn(['items', notificationId], notification);\n    }\n\n    case DELETE_NOTIFICATION:\n      return state.deleteIn(['items', action.payload.notificationId]);\n\n    case UPDATE_NOTIFICATION_SETTING:\n      return state.mergeDeepIn(['settings'], action.payload.setting);\n\n    default:\n      return state;\n  }\n}\n"],"names":["PERMISSION_GRANTED","PERMISSION_DENIED","isBrowserHidden","document","webkitHidden","mozHidden","msHidden","hidden","hasFocus","isNotificationSupported","window","Notification","requestPermissionForNotifications","callback","requestPermission","spawnNotification","theBody","theIcon","theTitle","timeoutLength","options","body","icon","browserNotification","setTimeout","close","getNotifications","state","notifications","get","getNotificationSettings","getUnsentNotifications","createSelector","toArray","map","notification","username","message","avatar","alertType","details","Object","assign","getNotificationDetails","notificationSettings","unsentNotifications","isSupported","permission","ADD_NOTIFICATION","DELETE_NOTIFICATION","UPDATE_NOTIFICATION_SETTING","addNotification","type","payload","deleteNotification","notificationId","updateNotificationSetting","setting","createNotification","dispatch","notificationSent","setNotificationPermission","setNotificationSupported","eventNames","NOTIFICATIONS_CREATED","NOTIFICATIONS_CLICKED","constructNotificationEventData","TIMEOUT_LENGTH","propTypes","PropTypes","array","bool","isMuted","string","onEvent","func","defaultProps","Notifications","Component","componentDidMount","props","setup","displayNotifications","shouldComponentUpdate","nextProps","componentDidUpdate","checkSupported","_","isNull","browserUtilities","hasPermission","length","forEach","n","addEventListener","render","connect","bindActionCreators","initialState","fromJS","items","settings","reducer","action","setIn","deleteIn","mergeDeepIn"],"mappings":"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"}